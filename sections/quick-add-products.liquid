{% schema %}
{
  "name": "t:sections.quick-add-products.name",
  "tag": "section",
  "class": "flat-spacing pt-0 pb-0",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    },
    {
      "type": "select",
      "id": "width",
      "label": "t:sections.all.width.label",
      "options": [
        {
          "value": "container",
          "label": "t:sections.all.width.options.boxed"
        },
        {
          "value": "container-full",
          "label": "t:sections.all.width.options.full_width"
        }
      ],
      "default": "container-full"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "t:sections.quick-add-products.settings.background_image.label",
      "info": "t:sections.quick-add-products.settings.background_image.info"
    },
    
    {
      "type": "text",
      "id": "title",
      "label": "t:sections.quick-add-products.settings.title.label",
      "default": "t:sections.quick-add-products.settings.title.default"
    },
    {
      "type": "select",
      "id": "title_tag",
      "label": "t:sections.quick-add-products.settings.title_tag.label",
      "options": [
        {
          "value": "h5",
          "label": "t:sections.quick-add-products.settings.title_tag.options.small.label"
        },
        {
          "value": "h4",
          "label": "t:sections.quick-add-products.settings.title_tag.options.medium.label"
        },
        {
          "value": "h3",
          "label": "t:sections.quick-add-products.settings.title_tag.options.large.label"
        }
      ],
      "default": "h4"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "t:sections.quick-add-products.settings.subtitle.label",
      "default": "t:sections.quick-add-products.settings.subtitle.default"
    },
    {
      "type": "select",
      "id": "subtitle_size",
      "label": "t:sections.quick-add-products.settings.subtitle_size.label",
      "options": [
        {
          "value": "text-sm",
          "label": "t:sections.quick-add-products.settings.subtitle_size.options.small.label"
        },
        {
          "value": "text-md",
          "label": "t:sections.quick-add-products.settings.subtitle_size.options.medium.label"
        },
        {
          "value": "text-lg",
          "label": "t:sections.quick-add-products.settings.subtitle_size.options.large.label"
        }
      ],
      "default": "text-md"
    },
    {
      "type": "header",
      "content": "t:sections.quick-add-products.settings.product_blocks_header.content"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "t:sections.quick-add-products.settings.layout.label",
      "options": [
        {
          "value": "layout-1",
          "label": "t:sections.quick-add-products.settings.layout.options.layout_1.label"
        },
        {
          "value": "layout-2",
          "label": "t:sections.quick-add-products.settings.layout.options.layout_2.label"
        }
      ],
      "default": "layout-1"
    },
    {
      "type": "header",
      "content": "t:sections.quick-add-products.settings.slider_settings_header.content"
    },
    
    {
      "type": "checkbox",
      "id": "show_dots_mobile",
      "label": "t:sections.quick-add-products.settings.show_dots_mobile.label",
      "default": true
    },
    {
      "type": "select",
      "id": "products_per_row_desktop",
      "label": "t:sections.quick-add-products.settings.products_per_row_desktop.label",
      "options": [
        { "value": "2", "label": "2" },
        { "value": "3", "label": "3" },
        { "value": "4", "label": "4" }
      ],
      "default": "3"
    },
    {
      "type": "select",
      "id": "products_per_row_tablet",
      "label": "t:sections.quick-add-products.settings.products_per_row_tablet.label",
      "options": [
        { "value": "1", "label": "1" },
        { "value": "2", "label": "2" },
        { "value": "3", "label": "3" }
      ],
      "default": "3"
    },
    {
      "type": "select",
      "id": "products_per_row_mobile",
      "label": "t:sections.quick-add-products.settings.products_per_row_mobile.label",
      "options": [
        { "value": "1", "label": "1" },
        { "value": "2", "label": "2" }
      ],
      "default": "1"
    },
    {
      "type": "header",
      "content": "t:sections.quick-add-products.settings.product_features_header.content"
    },
    {
      "type": "checkbox",
      "id": "show_product_features",
      "label": "t:sections.quick-add-products.settings.show_product_features.label",
      "default": true,
      "info": "t:sections.quick-add-products.settings.show_product_features.info"
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_mobile_rate",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "t:sections.top_bar.settings.padding_mobile_rate.label",
      "default": 75,
      "info": "t:sections.top_bar.settings.padding_mobile_rate.info"
    }
  ],
  "blocks": [
    {
      "type": "product",
      "name": "t:sections.quick-add-products.blocks.product.name",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "t:sections.quick-add-products.blocks.product.settings.product.label"
        },
        {
          "type": "text",
          "id": "custom_vendor",
          "label": "t:sections.quick-add-products.blocks.product.settings.custom_vendor.label",
          "info": "t:sections.quick-add-products.blocks.product.settings.custom_vendor.info"
        },
        {
          "type": "text",
          "id": "custom_title",
          "label": "t:sections.quick-add-products.blocks.product.settings.custom_title.label",
          "info": "t:sections.quick-add-products.blocks.product.settings.custom_title.info"
        },
        {
          "type": "image_picker",
          "id": "custom_image",
          "label": "t:sections.quick-add-products.blocks.product.settings.custom_image.label",
          "info": "t:sections.quick-add-products.blocks.product.settings.custom_image.info"
        },
        {
          "type": "text",
          "id": "product_features",
          "label": "t:sections.quick-add-products.blocks.product.settings.product_features.label",
          "info": "t:sections.quick-add-products.blocks.product.settings.product_features.info"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "t:sections.quick-add-products.presets.name",
      "category": "Product",
      "blocks": [
        {
          "type": "product",
          "settings": {
            "product_features": "Boosts Performance. Supports Muscle Growth. Speeds Up Recovery"
          }
        },
        {
          "type": "product",
          "settings": {
            "product_features": "Clean Formula. Tested Ingredients. Fast Absorption"
          }
        },
        {
          "type": "product",
          "settings": {
            "product_features": "Natural Ingredients. No Side Effects. Clinically Proven"
          }
        }
      ]
    }
  ]
}
{% endschema %}

{% style %}
  .section-{{ section.id }}-padding {
    padding-top: calc({{ section.settings.padding_top }}px * {{ section.settings.padding_mobile_rate | divided_by: 100.0 }});
    padding-bottom: calc({{ section.settings.padding_bottom }}px * {{ section.settings.padding_mobile_rate | divided_by: 100.0 }});
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{% endstyle %}

{% if section.settings.layout == 'layout-2' %}
  <!-- Layout 2: Featured Products Style -->
  <section class="flat-spacing-3 pt-0 section-{{ section.id }} color-{{ section.settings.color_scheme }} section-{{ section.id }}-padding">
    <div class="container">
      <{{ section.settings.title_tag }} class="flat-title-2 text-center text-dark-10">
        {{ section.settings.title }}
      </{{ section.settings.title_tag }}>
      {% if section.settings.subtitle != blank %}
        <p class="text-center {{ section.settings.subtitle_size }} text-grey-3 mt-2">
          {{ section.settings.subtitle }}
        </p>
      {% endif %}
      <div dir="ltr" class="swiper tf-swiper swiper-initialized swiper-horizontal swiper-backface-hidden" data-swiper='{
            "slidesPerView": {{ section.settings.products_per_row_mobile }},
            "spaceBetween": 12,
            "speed": 800,
            "observer": true,
            "observeParents": true,
            "slidesPerGroup": {{ section.settings.products_per_row_mobile }},
            {% if section.settings.show_dots_mobile %}
            "pagination": { "el": ".sw-pagination-featured", "clickable": true },
            {% endif %}
            "breakpoints": {
            "768": { "slidesPerView": {{ section.settings.products_per_row_tablet }}, "spaceBetween": 24, "slidesPerGroup": {{ section.settings.products_per_row_tablet }} },
            "1200": { "slidesPerView": {{ section.settings.products_per_row_desktop }}, "spaceBetween": 24, "slidesPerGroup": {{ section.settings.products_per_row_desktop }}}
            }
        }'>
        <div class="swiper-wrapper" aria-live="polite">
          {%- if section.blocks.size > 0 -%}
            {%- for block in section.blocks -%}
              {%- if block.type == 'product' and block.settings.product != blank -%}
                {%- assign product = block.settings.product -%}
                <div class="swiper-slide" role="group" aria-label="{{ forloop.index }} / {{ section.blocks.size }}" {{ block.shopify_attributes }}>
                  <div class="card-product style-wishlist style-3 style-bg">
                    <div class="card-product-wrapper asp-ratio-1">
                      <a href="{{ product.url }}" class="product-img">
                        {% if block.settings.custom_image %}
                          <img 
                            class="img-product ls-is-cached lazyloaded" 
                            data-src="{{ block.settings.custom_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                            src="{{ block.settings.custom_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                            alt="{{ block.settings.custom_image.alt | escape }}"
                            width="460"
                            height="460"
                          >
                          <img 
                            class="img-hover ls-is-cached lazyloaded" 
                            data-src="{{ block.settings.custom_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                            src="{{ block.settings.custom_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                            alt="{{ block.settings.custom_image.alt | escape }}"
                            width="460"
                            height="460"
                          >
                        {% elsif product.featured_image %}
                          <img 
                            class="img-product ls-is-cached lazyloaded" 
                            data-src="{{ product.featured_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                            src="{{ product.featured_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                            alt="{{ product.featured_image.alt | escape }}"
                            width="460"
                            height="460"
                          >
                          <img 
                            class="img-hover ls-is-cached lazyloaded" 
                            data-src="{{ product.images[1] | default: product.featured_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                            src="{{ product.images[1] | default: product.featured_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                            alt="{{ product.images[1].alt | default: product.featured_image.alt | escape }}"
                            width="460"
                            height="460"
                          >
                        {% endif %}
                      </a>
                      {% if product.available %}
                        <ul class="list-product-btn">
                          {% render 'product-wishlist-button', product: product, card_style: 'style-2' %}
                          {% render 'product-quickview-button', product: product, card_style: 'style-2' %}
                          {% render 'product-compare-button', product: product, card_style: 'style-2' %}
                        </ul>
                      {% endif %}
                    </div>
                    <div class="card-product-info text-center">
                      {%- assign display_vendor = block.settings.custom_vendor | default: product.vendor -%}
                      {% if display_vendor != blank %}
                        <div class="sub text-uppercase fw-semibold text-grey-3 text-xs">
                          {{ display_vendor | upcase }}
                        </div>
                      {% endif %}
                      {%- assign display_title = block.settings.custom_title | default: product.title -%}
                      <a href="{{ product.url }}" class="name-product fw-medium display-xs">
                        {{ display_title }}
                      </a>
                      <p class="price-wrap fw-semibold d-flex justify-content-center align-items-center gap-8">
                        <span class="price-new text-xl">
                          {%- if settings.currency_code_enabled -%}
                            {{- product.price | money }}
                            {{ shop.currency -}}
                          {%- else -%}
                            {{- product.price | money -}}
                          {%- endif -%}
                        </span>
                        {% if product.compare_at_price > product.price %}
                          <span class="price-old fw-medium text-sm">
                            {%- if settings.currency_code_enabled -%}
                              {{- product.compare_at_price | money }}
                              {{ shop.currency -}}
                            {%- else -%}
                              {{- product.compare_at_price | money -}}
                            {%- endif -%}
                          </span>
                        {% endif %}
                      </p>
                      {% if section.settings.show_product_features and block.settings.product_features != blank %}
                        <div class="dir"></div>
                        <ul class="list-infor">
                          {%- assign features = block.settings.product_features | split: '.' -%}
                          {%- for feature in features -%}
                            {%- assign trimmed_feature = feature | strip -%}
                            {%- if trimmed_feature != blank -%}
                              <li class="item">
                                <img src="{{ 'check.svg' | asset_url }}" alt="" width="16" height="16">
                                <div class="text-sm text text-grey-3">{{ trimmed_feature }}</div>
                              </li>
                            {%- endif -%}
                          {%- endfor -%}
                        </ul>
                      {% endif %}
                      {% render 'product-quick-add-button', product: product, style: 'style-2' %}
                    </div>
                  </div>
                </div>
              {%- endif -%}
            {%- endfor -%}
          {%- endif -%}
        </div>
        {% if section.settings.show_dots_mobile %}
          <div class="d-flex d-xl-none sw-dot-default sw-pagination-featured justify-content-center swiper-pagination-clickable swiper-pagination-bullets swiper-pagination-horizontal swiper-pagination-lock"></div>
        {% endif %}
        <span class="swiper-notification" aria-live="assertive" aria-atomic="true"></span>
      </div>
    </div>
  </section>
{% else %}
  <!-- Layout 1: Original Style -->
  <section class="container-full section-{{ section.id }} color-{{ section.settings.color_scheme }}">
    <div class="flat-spacing-33 bg-brown-17 overflow-hidden relative section-{{ section.id }}-padding">
      {% if section.settings.background_image %}
        <div class="tf-overlay">
          <img 
            src="{{ section.settings.background_image | image_url: width: 1920 }}" 
            alt="{{ section.settings.background_image.alt | escape }}" 
            class="effect-paralax"
            style="width: 100%; height: 100%; object-fit: cover;"
            width="1920"
            height="100%"
          >
        </div>
      {% endif %}
      
      <div class="{{ section.settings.width }} position-relative">
        <div class="flat-title wow fadeInUp" style="visibility: visible; animation-name: fadeInUp;">
          <{{ section.settings.title_tag }} class="title text-white">
            {{ section.settings.title }}
          </{{ section.settings.title_tag }}>
          {% if section.settings.subtitle != blank %}
            <p class="desc text-white fs-16">
              {{ section.settings.subtitle }}
            </p>
          {% endif %}
        </div>
        
        <div class="fl-control-sw2 wrap-pos-nav sw-over-product wow fadeInUp" style="visibility: visible; animation-name: fadeInUp;">
          <div 
            dir="ltr" 
            class="swiper tf-swiper wrap-sw-over swiper-initialized swiper-horizontal swiper-backface-hidden" 
            data-swiper='{
              "slidesPerView": {{ section.settings.products_per_row_mobile }},
              "spaceBetween": 12,
              "speed": 800,
              "slidesPerGroup": 2,
              {% if section.settings.show_dots_mobile %}
              "pagination": { "el": ".sw-pagination-seller1", "clickable": true },
              {% endif %}
              "breakpoints": {
                "768": { "slidesPerView": {{ section.settings.products_per_row_tablet }}, "spaceBetween": 12, "slidesPerGroup": 3 },
                "1200": { "slidesPerView": {{ section.settings.products_per_row_desktop }}, "spaceBetween": 24, "slidesPerGroup": 3 }
              }
            }'
          >
            <div class="swiper-wrapper" aria-live="polite">
              {%- if section.blocks.size > 0 -%}
                {%- for block in section.blocks -%}
                  {%- if block.type == 'product' and block.settings.product != blank -%}
                    {%- assign product = block.settings.product -%}
                    <div class="swiper-slide" role="group" aria-label="{{ forloop.index }} / {{ section.blocks.size }}" {{ block.shopify_attributes }}>
                      <div class="card-product">
                        <div class="card-product-wrapper rounded-0">
                          <a href="{{ product.url }}" class="product-img">
                            {% if block.settings.custom_image %}
                              <img 
                                class="img-product ls-is-cached lazyloaded" 
                                data-src="{{ block.settings.custom_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                                src="{{ block.settings.custom_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                                alt="{{ block.settings.custom_image.alt | escape }}"
                                width="460"
                                height="460"
                              >
                              <img 
                                class="img-hover ls-is-cached lazyloaded" 
                                data-src="{{ block.settings.custom_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                                src="{{ block.settings.custom_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                                alt="{{ block.settings.custom_image.alt | escape }}"
                                width="460"
                                height="460"
                              >
                            {% elsif product.featured_image %}
                              <img 
                                class="img-product ls-is-cached lazyloaded" 
                                data-src="{{ product.featured_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                                src="{{ product.featured_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                                alt="{{ product.featured_image.alt | escape }}"
                                width="460"
                                height="460"
                              >
                              <img 
                                class="img-hover ls-is-cached lazyloaded" 
                                data-src="{{ product.images[1] | default: product.featured_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                                src="{{ product.images[1] | default: product.featured_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                                alt="{{ product.images[1].alt | default: product.featured_image.alt | escape }}"
                                width="460"
                                height="460"
                              >
                            {% endif %}
                          </a>
                          {% if product.available %}
                            <ul class="list-product-btn">
                              {% render 'product-wishlist-button', product: product, card_style:  %}
                              {% render 'product-quickview-button', product: product, card_style:  %}
                              {% render 'product-compare-button', product: product, card_style:  %}
                            </ul>
                          {% endif %}
                        </div>
                        <div class="card-product-info text-center pb-0" style="background-color: rgb(var(--color-background2));">
                          {%- assign display_vendor = block.settings.custom_vendor | default: product.vendor -%}
                          {% if display_vendor != blank %}
                            <div class="sub fw-semibold font-13 text-xs fs-13" style="color: rgb(var(--color-foreground2));">
                              {{ display_vendor | upcase }}
                            </div>
                          {% endif %}
                          {%- assign display_title = block.settings.custom_title | default: product.title -%}
                          <a href="{{ product.url }}" class="name-product link fw-medium display-xs font-7 d-block mx-auto" style="max-width: 330px;">
                            {{ display_title }}
                          </a>
                          <p class="price-wrap fw-medium d-flex justify-content-center align-items-center gap-8">
                            <span class="price-new text-red-3 text-xl font-13">
                              {%- if settings.currency_code_enabled -%}
                                {{- product.price | money }}
                                {{ shop.currency -}}
                              {%- else -%}
                                {{- product.price | money -}}
                              {%- endif -%}
                            </span>
                            {% if product.compare_at_price > product.price %}
                              <span class="price-old text-sm font-13">
                                {%- if settings.currency_code_enabled -%}
                                  {{- product.compare_at_price | money }}
                                  {{ shop.currency -}}
                                {%- else -%}
                                  {{- product.compare_at_price | money -}}
                                {%- endif -%}
                              </span>
                            {% endif %}
                          </p>
                          {% if section.settings.show_product_features and block.settings.product_features != blank %}
                          <div class="line-top"></div>
                            <ul class="list-infor pb-30">
                              {%- assign features = block.settings.product_features | split: '.' -%}
                              {%- for feature in features -%}
                                {%- assign trimmed_feature = feature | strip -%}
                                {%- if trimmed_feature != blank -%}
                                  <li class="item">
                                    <img src="{{ 'check.svg' | asset_url }}" alt="" width="16" height="16">
                                    <div class="text-sm text-grey-3" style="color: rgb(var(--color-foreground3));">{{ trimmed_feature }}</div>
                                  </li>
                                {%- endif -%}
                              {%- endfor -%}
                            </ul>
                          {% endif %}
                          {% render 'product-quick-add-button', product: product, style: 'style-1' %}
                        </div>
                      </div>
                    </div>
                  {%- endif -%}
                {%- endfor -%}
              {%- endif -%}
            </div>
            {% if section.settings.show_dots_mobile %}
              <div class="d-flex d-xl-none mt_5 sw-dot-default style-white sw-pagination-seller1 justify-content-center swiper-pagination-clickable swiper-pagination-bullets swiper-pagination-horizontal swiper-pagination-lock"></div>
            {% endif %}
            <span class="swiper-notification" aria-live="assertive" aria-atomic="true"></span>
          </div>
        </div>
      </div>
    </div>
  </section>
{% endif %}

{% if section.settings.layout == 'layout-1' %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Initialize SimpleParallax for the background image (Layout 1 only)
  const parallaxElements = document.querySelectorAll('.section-{{ section.id }} .effect-paralax');
  if (parallaxElements.length > 0 && window.SimpleParallax) {
    new SimpleParallax(parallaxElements, {
      orientation: 'down',
      scale: 1.3,
      overflow: true,
      delay: 0.4,
      transition: 'cubic-bezier(0,0,0,1)'
    });
  }
});
</script>
{% endif %}
