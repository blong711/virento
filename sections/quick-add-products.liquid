{% schema %}
{
  "name": "Quick Add Products",
  "tag": "section",
  "class": "flat-spacing pt-0 pb-0",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    },
    {
      "type": "select",
      "id": "width",
      "label": "t:sections.all.width.label",
      "options": [
        {
          "value": "container",
          "label": "t:sections.all.width.options.boxed"
        },
        {
          "value": "container-full",
          "label": "t:sections.all.width.options.full_width"
        }
      ],
      "default": "container-full"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background Image",
      "info": "Background image for the section"
    },
    {
      "type": "select",
      "id": "title_alignment",
      "label": "Title Alignment",
      "options": [
        {
          "value": "start",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        }
      ],
      "default": "start"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "default": "Featured Products"
    },
    {
      "type": "select",
      "id": "title_tag",
      "label": "Title Size",
      "options": [
        {
          "value": "h5",
          "label": "Small"
        },
        {
          "value": "h4",
          "label": "Medium"
        },
        {
          "value": "h3",
          "label": "Large"
        }
      ],
      "default": "h4"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Section Subtitle",
      "default": "Explore our most popular pieces that customers can't get enough of"
    },
    {
      "type": "select",
      "id": "subtitle_size",
      "label": "Subtitle Size",
      "options": [
        {
          "value": "text-sm",
          "label": "Small"
        },
        {
          "value": "text-md",
          "label": "Medium"
        },
        {
          "value": "text-lg",
          "label": "Large"
        }
      ],
      "default": "text-md"
    },
    {
      "type": "header",
      "content": "Product Blocks"
    },
    {
      "type": "header",
      "content": "Slider Settings"
    },
    {
      "type": "checkbox",
      "id": "show_navigation",
      "label": "Show Navigation Arrows",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_dots_mobile",
      "label": "Show Dots on Mobile",
      "default": true
    },
    {
      "type": "select",
      "id": "products_per_row_desktop",
      "label": "Products per row (Desktop)",
      "options": [
        { "value": "2", "label": "2" },
        { "value": "3", "label": "3" },
        { "value": "4", "label": "4" }
      ],
      "default": "3"
    },
    {
      "type": "select",
      "id": "products_per_row_tablet",
      "label": "Products per row (Tablet)",
      "options": [
        { "value": "1", "label": "1" },
        { "value": "2", "label": "2" },
        { "value": "3", "label": "3" }
      ],
      "default": "3"
    },
    {
      "type": "select",
      "id": "products_per_row_mobile",
      "label": "Products per row (Mobile)",
      "options": [
        { "value": "1", "label": "1" },
        { "value": "2", "label": "2" },
      ],
      "default": "1"
    },
    {
      "type": "header",
      "content": "Product Features"
    },
    {
      "type": "checkbox",
      "id": "show_product_features",
      "label": "Show Product Features",
      "default": true,
      "info": "Display the feature list below product info"
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_mobile_rate",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "t:sections.top_bar.settings.padding_mobile_rate.label",
      "default": 75,
      "info": "t:sections.top_bar.settings.padding_mobile_rate.info"
    }
  ],
  "blocks": [
    {
      "type": "product",
      "name": "Product",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Product"
        },
        {
          "type": "text",
          "id": "custom_vendor",
          "label": "Custom Vendor",
          "info": "Override the product vendor (leave blank to use product default)"
        },
        {
          "type": "text",
          "id": "custom_title",
          "label": "Custom Title",
          "info": "Override the product title (leave blank to use product default)"
        },
        {
          "type": "text",
          "id": "product_features",
          "label": "Product Features",
          "info": "Enter features separated by dots (e.g., Boosts Performance. Supports Muscle Growth. Speeds Up Recovery)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Quick Add Products",
      "category": "Product",
      "blocks": [
        {
          "type": "product",
          "settings": {
            "product_features": "Boosts Performance. Supports Muscle Growth. Speeds Up Recovery"
          }
        },
        {
          "type": "product",
          "settings": {
            "product_features": "Clean Formula. Tested Ingredients. Fast Absorption"
          }
        },
        {
          "type": "product",
          "settings": {
            "product_features": "Natural Ingredients. No Side Effects. Clinically Proven"
          }
        }
      ]
    }
  ]
}
{% endschema %}

{% style %}
  .section-{{ section.id }}-padding {
    padding-top: calc({{ section.settings.padding_top }}px * {{ section.settings.padding_mobile_rate | divided_by: 100.0 }});
    padding-bottom: calc({{ section.settings.padding_bottom }}px * {{ section.settings.padding_mobile_rate | divided_by: 100.0 }});
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{% endstyle %}

<section class="container-full section-{{ section.id }} color-{{ section.settings.color_scheme }}">
  <div class="flat-spacing-33 bg-brown-17 overflow-hidden relative section-{{ section.id }}-padding">
    {% if section.settings.background_image %}
      <div class="tf-overlay">
        <img 
          src="{{ section.settings.background_image | image_url: width: 1920 }}" 
          alt="{{ section.settings.background_image.alt | escape }}" 
          class="effect-paralax"
          style="width: 100%; height: 100%; object-fit: cover;"
          width="1920"
          height="100%"
        >
      </div>
    {% endif %}
    
    <div class="{{ section.settings.width }} position-relative">
      <div class="flat-title wow fadeInUp {% if section.settings.title_alignment == 'center' %} text-center{% endif %}" style="visibility: visible; animation-name: fadeInUp;">
        <{{ section.settings.title_tag }} class="title text-white">
          {{ section.settings.title }}
        </{{ section.settings.title_tag }}>
        {% if section.settings.subtitle != blank %}
          <p class="desc text-white fs-16">
            {{ section.settings.subtitle }}
          </p>
        {% endif %}
      </div>
      
      <div class="fl-control-sw2 wrap-pos-nav sw-over-product wow fadeInUp" style="visibility: visible; animation-name: fadeInUp;">
        <div 
          dir="ltr" 
          class="swiper tf-swiper wrap-sw-over swiper-initialized swiper-horizontal swiper-backface-hidden" 
          data-swiper='{
            "slidesPerView": {{ section.settings.products_per_row_mobile }},
            "spaceBetween": 12,
            "speed": 800,
            "slidesPerGroup": 2,
            {% if section.settings.show_dots_mobile %}
            "pagination": { "el": ".sw-pagination-seller1", "clickable": true },
            {% endif %}
            "breakpoints": {
              "768": { "slidesPerView": {{ section.settings.products_per_row_tablet }}, "spaceBetween": 12, "slidesPerGroup": 3 },
              "1200": { "slidesPerView": {{ section.settings.products_per_row_desktop }}, "spaceBetween": 24, "slidesPerGroup": 3 }
            }
          }'
        >
          <div class="swiper-wrapper" aria-live="polite">
            {%- if section.blocks.size > 0 -%}
              {%- for block in section.blocks -%}
                {%- if block.type == 'product' and block.settings.product != blank -%}
                  {%- assign product = block.settings.product -%}
                  <div class="swiper-slide" role="group" aria-label="{{ forloop.index }} / {{ section.blocks.size }}" {{ block.shopify_attributes }}>
                    <div class="card-product">
                      <div class="card-product-wrapper rounded-0">
                        <a href="{{ product.url }}" class="product-img">
                          {% if product.featured_image %}
                            <img 
                              class="img-product ls-is-cached lazyloaded" 
                              data-src="{{ product.featured_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                              src="{{ product.featured_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                              alt="{{ product.featured_image.alt | escape }}"
                              width="460"
                              height="460"
                            >
                            <img 
                              class="img-hover ls-is-cached lazyloaded" 
                              data-src="{{ product.images[1] | default: product.featured_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                              src="{{ product.images[1] | default: product.featured_image | image_url: width: 460, height: 460, crop: 'center' }}" 
                              alt="{{ product.images[1].alt | default: product.featured_image.alt | escape }}"
                              width="460"
                              height="460"
                            >
                          {% endif %}
                        </a>
                        {% if product.available %}
                          <ul class="list-product-btn">
                            {% render 'product-wishlist-button', product: product, card_style:  %}
                            {% render 'product-quickview-button', product: product, card_style:  %}
                            {% render 'product-compare-button', product: product, card_style:  %}
                          </ul>
                        {% endif %}
                      </div>
                      <div class="card-product-info text-center bg-white pb-0">
                        {%- assign display_vendor = block.settings.custom_vendor | default: product.vendor -%}
                        {% if display_vendor != blank %}
                          <div class="sub fw-semibold font-13 text-dark-purple-2 text-xs fs-13">
                            {{ display_vendor | upcase }}
                          </div>
                        {% endif %}
                        {%- assign display_title = block.settings.custom_title | default: product.title -%}
                        <a href="{{ product.url }}" class="name-product link fw-medium display-xs font-7">
                          {{ display_title }}
                        </a>
                        <p class="price-wrap fw-medium d-flex justify-content-center align-items-center gap-8">
                          <span class="price-new text-red-3 text-xl font-13">
                            {%- if settings.currency_code_enabled -%}
                              {{- product.price | money }}
                              {{ shop.currency -}}
                            {%- else -%}
                              {{- product.price | money -}}
                            {%- endif -%}
                          </span>
                          {% if product.compare_at_price > product.price %}
                            <span class="price-old text-sm font-13">
                              {%- if settings.currency_code_enabled -%}
                                {{- product.compare_at_price | money }}
                                {{ shop.currency -}}
                              {%- else -%}
                                {{- product.compare_at_price | money -}}
                              {%- endif -%}
                            </span>
                          {% endif %}
                        </p>
                        <div class="line-top"></div>
                        {% if section.settings.show_product_features and block.settings.product_features != blank %}
                          <ul class="list-infor pb-30">
                            {%- assign features = block.settings.product_features | split: '.' -%}
                            {%- for feature in features -%}
                              {%- assign trimmed_feature = feature | strip -%}
                              {%- if trimmed_feature != blank -%}
                                <li class="item">
                                  <img src="{{ 'check.svg' | asset_url }}" alt="" width="16" height="16">
                                  <div class="text-sm text-grey-3">{{ trimmed_feature }}</div>
                                </li>
                              {%- endif -%}
                            {%- endfor -%}
                          </ul>
                        {% endif %}
                        {% render 'product-quick-add-button', product: product %}
                      </div>
                    </div>
                  </div>
                {%- endif -%}
              {%- endfor -%}
            {%- endif -%}
          </div>
          {% if section.settings.show_dots_mobile %}
            <div class="d-flex d-xl-none mt_5 sw-dot-default style-white sw-pagination-seller1 justify-content-center swiper-pagination-clickable swiper-pagination-bullets swiper-pagination-horizontal swiper-pagination-lock"></div>
          {% endif %}
          <span class="swiper-notification" aria-live="assertive" aria-atomic="true"></span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Quick Add Modal -->
{% render 'quick-add-modal'%}

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Initialize SimpleParallax for the background image
  const parallaxElements = document.querySelectorAll('.section-{{ section.id }} .effect-paralax');
  if (parallaxElements.length > 0 && window.SimpleParallax) {
    new SimpleParallax(parallaxElements, {
      orientation: 'down',
      scale: 1.3,
      overflow: true,
      delay: 0.4,
      transition: 'cubic-bezier(0,0,0,1)'
    });
  }
});
</script>
